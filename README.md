# JHRホテル業績KPIデータベース（2015-2025年）

ジャパン・ホテル・リート投資法人（JHR）のホテル業績に関するKPIを、公式Excelファイルから抽出した11年間分の包括的データベースです。

## 📊 データセット概要

- **対象期間**：2015年～2025年（11年間）
- **データソース**：JHR公式IRライブラリのExcelファイル
- **総記録数**：126ヶ月分の実績データ
- **抽出成功率**：100%（11年間すべてのデータを抽出完了）

## 🎯 主要業績指標

- **稼働率（％）**：客室の月間稼働率
- **ADR（日本円）**：平均客室単価
- **RevPAR（日本円）**：利用可能客室1室あたりの収益
- **売上高（百万円）**：月間総売上高

## 📁 プロジェクト構成

```
jhr/
├── README.md                              # 本ファイル
├── data/                                  # Excelソースファイル（11年分）
│   ├── jhr_2015_hotel_performance.xlsx
│   ├── jhr_2016_hotel_performance.xlsx
│   └── ...（2025年分まで）
├── src/                                   # 処理スクリプト
│   ├── get.py                            # Excelファイル自動ダウンロード
│   ├── fixed_yaml_generator.py           # 修正済み抽出ロジック
│   ├── create_comprehensive_yaml.py      # 代替抽出方法
│   └── detailed_excel_inspector.py       # Excelファイル構造解析
├── jhr_11year_fixed_kpi.yaml            # 主要出力ファイル（修正版）
└── jhr_11year_comprehensive_kpi.yaml    # 代替出力ファイル
```

## 🚀 使用方法

### クイックスタート

1. **YAMLデータベースの生成**：
   ```bash
   python3 src/fixed_yaml_generator.py
   ```

2. **最新Excelファイルのダウンロード**：
   ```bash
   python3 src/get.py --download-all
   ```

### データファイル

- **主要データ**：`jhr_11year_fixed_kpi.yaml` - 修正済み抽出ロジックを採用した推奨データセット
- **代替データ**：`jhr_11year_comprehensive_kpi.yaml` - 別の抽出手法によるデータセット

## 📈 データ品質とカバー範囲

### 正常に抽出された期間
- ✅ **2015-2018年**：旧HMJ形式（個別ホテル別データ）
- ✅ **2019年**：変動賃料21ホテル形式（個別→集計データ）
- ✅ **2020-2023年**：コロナ禍におけるHMJ形式（個別→集計データ）  
- ✅ **2024-2025年**：最新の28ホテル集計形式

### 特別期間
- **2020-2022年**：新型コロナウイルス感染症の影響期間（低稼働率が記録されている）
- **2019年**：ラグビーワールドカップ開催の影響期間
- **2023年以降**：インバウンド観光回復期

## 🛠️ 技術的特徴

### 複数形式Excelファイルの処理
- 11年間にわたる4種類の異なるExcelシート構造に対応
- シート自動検出とフォーマット適応機能
- 堅牢なデータ検証と変換処理

### データ抽出機能
- 小数点値から百分率への変換処理（例：0.816→81.6%）
- 個別ホテルデータの複数ホテル集計処理
- 2019年形式におけるKPI継続パターンの処理
- コロナ禍データの正規化処理

## 📊 サンプルデータ

```yaml
'2024':
  monthly_data:
    '01':
      occupancy_pct: 87.2
      adr_jpy: 9168
      revpar_jpy: 7990
      sales_total_mil_jpy: 46
  annual_summary:
    occupancy_avg_pct: 87.9
    adr_avg_jpy: 11464
    sales_total_annual_mil_jpy: 672
```

## 🔄 更新方法

以下のコマンドを実行することでデータセットを更新できます：
```bash
python3 src/get.py --download-all --update-yaml
```

この処理では以下の手順が実行されます：
1. JHR公式IRライブラリから最新Excelファイルをダウンロード
2. 確立された抽出パターンを用いて新規データを処理
3. 更新された情報を含むYAMLデータベースを再生成

## 📋 データソース

- **主要ソース**：[JHR公式ポートフォリオレビュー](https://www.jhrth.co.jp/ja/portfolio/review.html)
- **IRライブラリ**：[JHR IR文書ライブラリ](https://www.jhrth.co.jp/ja/ir/library.html)
- **データ形式**：公式月次業績Excelファイル

## ⚠️ 注意事項

- すべての値は**実績データ**であり、推計値ではありません
- 2025年データは一部のみ利用可能です（抽出時点時点で1月～6月分まで）
- 通貨値は日本円（JPY）で表示されています
- 売上高は百万円単位で記載されています

---

**生成日**：2025年9月7日  
**データ範囲**：2015-2025年（11年間）  
**総カバー期間**：126ヶ月分のホテル業績データ
